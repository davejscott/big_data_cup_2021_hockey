mutate(rec_x = if_else(lag(event, n = 1L) == "Play", lag(x_coordinate_2, n = 1L), NA_real_)) %>%
mutate(rec_y = if_else(lag(event, n = 1L) == "Play", lag(y_coordinate_2, n = 1L), NA_real_)) %>%
mutate(shooter = if_else(event %in% c("Shot", "Goal"), player, NA_character_)) %>%
mutate(shot_x = if_else(event %in% c("Shot", "Goal"), x_coordinate, NA_real_)) %>%
mutate(shot_y = if_else(event %in% c("Shot", "Goal"), y_coordinate, NA_real_)) %>%
mutate(shot_type = if_else(event %in% c("Shot", "Goal"), detail_1, NA_character_)) %>%
mutate(shot_outcome = if_else(event %in% c("Shot", "Goal"), detail_2, NA_character_)) %>%
mutate(shot_traffic = if_else(event %in% c("Shot", "Goal"), detail_3, NA)) %>%
mutate(shot_onetimer = if_else(event %in% c("Shot", "Goal"), detail_4, NA)) %>%
filter(shot_from_pass == TRUE) %>%
select(-c(clock, player, detail_1, detail_2, detail_3, detail_4, player_2,
x_coordinate, y_coordinate, x_coordinate_2, y_coordinate_2,
shot_from_pass, pass_to_shot)) %>%
rename(time_since_pass = time_btw_events) %>%
filter(time_since_pass < 3) %>%
filter(pass_type == "Direct") %>%
filter(shot_outcome == "On Net") %>%
filter(team == "Boston Pride")
ggplot(data = data) +
geom_segment(aes(x = pass_x, y = pass_y, xend = rec_x, yend = rec_y),
arrow = arrow(length = unit(0.1, "cm")),
colour = "black") +
# scale_colour_manual(values = "red") +
geom_segment(aes(x = rec_x, y = rec_y, xend = shot_x, yend = shot_y),
arrow = arrow(length = unit(0.1, "cm")),
colour = "red") +
labs(x = "",
y = "") +
coord_fixed() +
theme_classic()
data <- data_nwhl %>%
mutate(passer = if_else(lag(event, n = 1L) == "Play", lag(player, n = 1L), NA_character_)) %>%
mutate(pass_type = if_else(lag(detail_1, n = 1L) %in% c("Direct", "Indirect"), lag(detail_1, n = 1L), NA_character_)) %>%
mutate(pass_x = if_else(lag(event, n = 1L) == "Play", lag(x_coordinate, n = 1L), NA_real_)) %>%
mutate(pass_y = if_else(lag(event, n = 1L) == "Play", lag(y_coordinate, n = 1L), NA_real_)) %>%
mutate(rec_x = if_else(lag(event, n = 1L) == "Play", lag(x_coordinate_2, n = 1L), NA_real_)) %>%
mutate(rec_y = if_else(lag(event, n = 1L) == "Play", lag(y_coordinate_2, n = 1L), NA_real_)) %>%
mutate(shooter = if_else(event %in% c("Shot", "Goal"), player, NA_character_)) %>%
mutate(shot_x = if_else(event %in% c("Shot", "Goal"), x_coordinate, NA_real_)) %>%
mutate(shot_y = if_else(event %in% c("Shot", "Goal"), y_coordinate, NA_real_)) %>%
mutate(shot_type = if_else(event %in% c("Shot", "Goal"), detail_1, NA_character_)) %>%
mutate(shot_outcome = if_else(event %in% c("Shot", "Goal"), detail_2, NA_character_)) %>%
mutate(shot_traffic = if_else(event %in% c("Shot", "Goal"), detail_3, NA)) %>%
mutate(shot_onetimer = if_else(event %in% c("Shot", "Goal"), detail_4, NA)) %>%
filter(shot_from_pass == TRUE) %>%
select(-c(clock, player, detail_1, detail_2, detail_3, detail_4, player_2,
x_coordinate, y_coordinate, x_coordinate_2, y_coordinate_2,
shot_from_pass, pass_to_shot)) %>%
rename(time_since_pass = time_btw_events) %>%
filter(time_since_pass < 3) %>%
filter(pass_type == "Direct") %>%
filter(shot_outcome == "On Net") %>%
filter(team == "Boston Pride") %>%
filter(date = "2021-01-23")
data <- data_nwhl %>%
mutate(passer = if_else(lag(event, n = 1L) == "Play", lag(player, n = 1L), NA_character_)) %>%
mutate(pass_type = if_else(lag(detail_1, n = 1L) %in% c("Direct", "Indirect"), lag(detail_1, n = 1L), NA_character_)) %>%
mutate(pass_x = if_else(lag(event, n = 1L) == "Play", lag(x_coordinate, n = 1L), NA_real_)) %>%
mutate(pass_y = if_else(lag(event, n = 1L) == "Play", lag(y_coordinate, n = 1L), NA_real_)) %>%
mutate(rec_x = if_else(lag(event, n = 1L) == "Play", lag(x_coordinate_2, n = 1L), NA_real_)) %>%
mutate(rec_y = if_else(lag(event, n = 1L) == "Play", lag(y_coordinate_2, n = 1L), NA_real_)) %>%
mutate(shooter = if_else(event %in% c("Shot", "Goal"), player, NA_character_)) %>%
mutate(shot_x = if_else(event %in% c("Shot", "Goal"), x_coordinate, NA_real_)) %>%
mutate(shot_y = if_else(event %in% c("Shot", "Goal"), y_coordinate, NA_real_)) %>%
mutate(shot_type = if_else(event %in% c("Shot", "Goal"), detail_1, NA_character_)) %>%
mutate(shot_outcome = if_else(event %in% c("Shot", "Goal"), detail_2, NA_character_)) %>%
mutate(shot_traffic = if_else(event %in% c("Shot", "Goal"), detail_3, NA)) %>%
mutate(shot_onetimer = if_else(event %in% c("Shot", "Goal"), detail_4, NA)) %>%
filter(shot_from_pass == TRUE) %>%
select(-c(clock, player, detail_1, detail_2, detail_3, detail_4, player_2,
x_coordinate, y_coordinate, x_coordinate_2, y_coordinate_2,
shot_from_pass, pass_to_shot)) %>%
rename(time_since_pass = time_btw_events) %>%
filter(time_since_pass < 3) %>%
filter(pass_type == "Direct") %>%
filter(shot_outcome == "On Net") %>%
filter(team == "Boston Pride") %>%
filter(date == "2021-01-23")
data <- data_nwhl %>%
mutate(passer = if_else(lag(event, n = 1L) == "Play", lag(player, n = 1L), NA_character_)) %>%
mutate(pass_type = if_else(lag(detail_1, n = 1L) %in% c("Direct", "Indirect"), lag(detail_1, n = 1L), NA_character_)) %>%
mutate(pass_x = if_else(lag(event, n = 1L) == "Play", lag(x_coordinate, n = 1L), NA_real_)) %>%
mutate(pass_y = if_else(lag(event, n = 1L) == "Play", lag(y_coordinate, n = 1L), NA_real_)) %>%
mutate(rec_x = if_else(lag(event, n = 1L) == "Play", lag(x_coordinate_2, n = 1L), NA_real_)) %>%
mutate(rec_y = if_else(lag(event, n = 1L) == "Play", lag(y_coordinate_2, n = 1L), NA_real_)) %>%
mutate(shooter = if_else(event %in% c("Shot", "Goal"), player, NA_character_)) %>%
mutate(shot_x = if_else(event %in% c("Shot", "Goal"), x_coordinate, NA_real_)) %>%
mutate(shot_y = if_else(event %in% c("Shot", "Goal"), y_coordinate, NA_real_)) %>%
mutate(shot_type = if_else(event %in% c("Shot", "Goal"), detail_1, NA_character_)) %>%
mutate(shot_outcome = if_else(event %in% c("Shot", "Goal"), detail_2, NA_character_)) %>%
mutate(shot_traffic = if_else(event %in% c("Shot", "Goal"), detail_3, NA)) %>%
mutate(shot_onetimer = if_else(event %in% c("Shot", "Goal"), detail_4, NA)) %>%
filter(shot_from_pass == TRUE) %>%
select(-c(clock, player, detail_1, detail_2, detail_3, detail_4, player_2,
x_coordinate, y_coordinate, x_coordinate_2, y_coordinate_2,
shot_from_pass, pass_to_shot)) %>%
rename(time_since_pass = time_btw_events) %>%
filter(time_since_pass < 3) %>%
filter(pass_type == "Direct") %>%
filter(shot_outcome == "On Net") %>%
filter(team == "Boston Pride") %>%
filter(date == as.Date("2021-01-23"))
data <- data_nwhl %>%
mutate(passer = if_else(lag(event, n = 1L) == "Play", lag(player, n = 1L), NA_character_)) %>%
mutate(pass_type = if_else(lag(detail_1, n = 1L) %in% c("Direct", "Indirect"), lag(detail_1, n = 1L), NA_character_)) %>%
mutate(pass_x = if_else(lag(event, n = 1L) == "Play", lag(x_coordinate, n = 1L), NA_real_)) %>%
mutate(pass_y = if_else(lag(event, n = 1L) == "Play", lag(y_coordinate, n = 1L), NA_real_)) %>%
mutate(rec_x = if_else(lag(event, n = 1L) == "Play", lag(x_coordinate_2, n = 1L), NA_real_)) %>%
mutate(rec_y = if_else(lag(event, n = 1L) == "Play", lag(y_coordinate_2, n = 1L), NA_real_)) %>%
mutate(shooter = if_else(event %in% c("Shot", "Goal"), player, NA_character_)) %>%
mutate(shot_x = if_else(event %in% c("Shot", "Goal"), x_coordinate, NA_real_)) %>%
mutate(shot_y = if_else(event %in% c("Shot", "Goal"), y_coordinate, NA_real_)) %>%
mutate(shot_type = if_else(event %in% c("Shot", "Goal"), detail_1, NA_character_)) %>%
mutate(shot_outcome = if_else(event %in% c("Shot", "Goal"), detail_2, NA_character_)) %>%
mutate(shot_traffic = if_else(event %in% c("Shot", "Goal"), detail_3, NA)) %>%
mutate(shot_onetimer = if_else(event %in% c("Shot", "Goal"), detail_4, NA)) %>%
filter(shot_from_pass == TRUE) %>%
select(-c(clock, player, detail_1, detail_2, detail_3, detail_4, player_2,
x_coordinate, y_coordinate, x_coordinate_2, y_coordinate_2,
shot_from_pass, pass_to_shot)) %>%
rename(time_since_pass = time_btw_events) %>%
filter(time_since_pass < 3) %>%
filter(pass_type == "Direct") %>%
filter(shot_outcome == "On Net") %>%
filter(team == "Boston Pride") %>%
filter(date == as.character("2021-01-23"))
data <- data_nwhl %>%
mutate(passer = if_else(lag(event, n = 1L) == "Play", lag(player, n = 1L), NA_character_)) %>%
mutate(pass_type = if_else(lag(detail_1, n = 1L) %in% c("Direct", "Indirect"), lag(detail_1, n = 1L), NA_character_)) %>%
mutate(pass_x = if_else(lag(event, n = 1L) == "Play", lag(x_coordinate, n = 1L), NA_real_)) %>%
mutate(pass_y = if_else(lag(event, n = 1L) == "Play", lag(y_coordinate, n = 1L), NA_real_)) %>%
mutate(rec_x = if_else(lag(event, n = 1L) == "Play", lag(x_coordinate_2, n = 1L), NA_real_)) %>%
mutate(rec_y = if_else(lag(event, n = 1L) == "Play", lag(y_coordinate_2, n = 1L), NA_real_)) %>%
mutate(shooter = if_else(event %in% c("Shot", "Goal"), player, NA_character_)) %>%
mutate(shot_x = if_else(event %in% c("Shot", "Goal"), x_coordinate, NA_real_)) %>%
mutate(shot_y = if_else(event %in% c("Shot", "Goal"), y_coordinate, NA_real_)) %>%
mutate(shot_type = if_else(event %in% c("Shot", "Goal"), detail_1, NA_character_)) %>%
mutate(shot_outcome = if_else(event %in% c("Shot", "Goal"), detail_2, NA_character_)) %>%
mutate(shot_traffic = if_else(event %in% c("Shot", "Goal"), detail_3, NA)) %>%
mutate(shot_onetimer = if_else(event %in% c("Shot", "Goal"), detail_4, NA)) %>%
filter(shot_from_pass == TRUE) %>%
select(-c(clock, player, detail_1, detail_2, detail_3, detail_4, player_2,
x_coordinate, y_coordinate, x_coordinate_2, y_coordinate_2,
shot_from_pass, pass_to_shot)) %>%
rename(time_since_pass = time_btw_events) %>%
filter(time_since_pass < 3) %>%
filter(pass_type == "Direct") %>%
filter(shot_outcome == "On Net") %>%
filter(team == "Boston Pride") %>%
filter(game_date == "2021-01-23")
ggplot(data = data) +
geom_segment(aes(x = pass_x, y = pass_y, xend = rec_x, yend = rec_y),
arrow = arrow(length = unit(0.1, "cm")),
colour = "black") +
# scale_colour_manual(values = "red") +
geom_segment(aes(x = rec_x, y = rec_y, xend = shot_x, yend = shot_y),
arrow = arrow(length = unit(0.1, "cm")),
colour = "red") +
labs(x = "",
y = "") +
coord_fixed() +
theme_classic()
ggplot(data = data) +
geom_segment(aes(x = pass_x, y = pass_y, xend = rec_x, yend = rec_y),
arrow = arrow(length = unit(0.1, "cm")),
colour = "black") +
# scale_colour_manual(values = "red") +
geom_segment(aes(x = rec_x, y = rec_y, xend = shot_x, yend = shot_y),
arrow = arrow(length = unit(0.1, "cm")),
colour = "red") +
labs(x = "",
y = "") +
lims(x = c(0, 200),
y = c(0, 85))
ggplot(data = data) +
geom_segment(aes(x = pass_x, y = pass_y, xend = rec_x, yend = rec_y),
arrow = arrow(length = unit(0.1, "cm")),
colour = "black") +
# scale_colour_manual(values = "red") +
geom_segment(aes(x = rec_x, y = rec_y, xend = shot_x, yend = shot_y),
arrow = arrow(length = unit(0.1, "cm")),
colour = "red") +
labs(x = "",
y = "") +
lims(x = c(0, 200),
y = c(0, 85)) +
coord_fixed() +
theme_classic()
ggplot(data = data) +
geom_segment(aes(x = pass_x, y = pass_y, xend = rec_x, yend = rec_y),
arrow = arrow(length = unit(1, "cm")),
colour = "black") +
# scale_colour_manual(values = "red") +
geom_segment(aes(x = rec_x, y = rec_y, xend = shot_x, yend = shot_y),
arrow = arrow(length = unit(0.1, "cm")),
colour = "red") +
labs(x = "",
y = "") +
lims(x = c(0, 200),
y = c(0, 85)) +
coord_fixed() +
theme_classic()
ggplot(data = data) +
geom_segment(aes(x = pass_x, y = pass_y, xend = rec_x, yend = rec_y),
arrow = arrow(length = unit(1, "cm")),
colour = "black") +
# scale_colour_manual(values = "red") +
geom_segment(aes(x = rec_x, y = rec_y, xend = shot_x, yend = shot_y),
arrow = arrow(length = unit(0.5, "cm")),
colour = "red") +
labs(x = "",
y = "") +
lims(x = c(0, 200),
y = c(0, 85)) +
coord_fixed() +
theme_classic()
ggplot(data = data) +
geom_segment(aes(x = pass_x, y = pass_y, xend = rec_x, yend = rec_y),
arrow = arrow(length = unit(0.5, "cm")),
colour = "black") +
# scale_colour_manual(values = "red") +
geom_segment(aes(x = rec_x, y = rec_y, xend = shot_x, yend = shot_y),
arrow = arrow(length = unit(0.5, "cm")),
colour = "red") +
labs(x = "",
y = "") +
lims(x = c(0, 200),
y = c(0, 85)) +
coord_fixed() +
theme_classic()
ggplot(data = data) +
geom_segment(aes(x = pass_x, y = pass_y, xend = rec_x, yend = rec_y),
arrow = arrow(length = unit(0.3, "cm")),
colour = "black") +
# scale_colour_manual(values = "red") +
geom_segment(aes(x = rec_x, y = rec_y, xend = shot_x, yend = shot_y),
arrow = arrow(length = unit(0.3, "cm")),
colour = "red") +
labs(x = "",
y = "") +
lims(x = c(0, 200),
y = c(0, 85)) +
coord_fixed() +
theme_classic()
ggplot(data = data) +
geom_segment(aes(x = pass_x, y = pass_y, xend = rec_x, yend = rec_y),
arrow = arrow(length = unit(0.3, "cm"))) +
# scale_colour_manual(values = "red") +
geom_segment(aes(x = rec_x, y = rec_y, xend = shot_x, yend = shot_y, colour = shot_outcome),
arrow = arrow(length = unit(0.3, "cm"))) +
labs(x = "",
y = "") +
lims(x = c(0, 200),
y = c(0, 85)) +
coord_fixed() +
theme_classic()
ggplot(data = data) +
geom_segment(aes(x = pass_x, y = pass_y, xend = rec_x, yend = rec_y),
arrow = arrow(length = unit(0.3, "cm"))) +
# scale_colour_manual(values = "red") +
geom_segment(aes(x = rec_x, y = rec_y, xend = shot_x, yend = shot_y, colour = shot_traffic),
arrow = arrow(length = unit(0.3, "cm"))) +
labs(x = "",
y = "") +
lims(x = c(0, 200),
y = c(0, 85)) +
coord_fixed() +
theme_classic()
ggplot(data = data) +
geom_segment(aes(x = pass_x, y = pass_y, xend = rec_x, yend = rec_y),
arrow = arrow(length = unit(0.3, "cm"))) +
# scale_colour_manual(values = "red") +
geom_segment(aes(x = rec_x, y = rec_y, xend = shot_x, yend = shot_y, colour = shot_onetimer),
arrow = arrow(length = unit(0.3, "cm"))) +
labs(x = "",
y = "") +
lims(x = c(0, 200),
y = c(0, 85)) +
coord_fixed() +
theme_classic()
data <- data_nwhl %>%
mutate(passer = if_else(lag(event, n = 1L) == "Play", lag(player, n = 1L), NA_character_)) %>%
mutate(pass_type = if_else(lag(detail_1, n = 1L) %in% c("Direct", "Indirect"), lag(detail_1, n = 1L), NA_character_)) %>%
mutate(pass_x = if_else(lag(event, n = 1L) == "Play", lag(x_coordinate, n = 1L), NA_real_)) %>%
mutate(pass_y = if_else(lag(event, n = 1L) == "Play", lag(y_coordinate, n = 1L), NA_real_)) %>%
mutate(rec_x = if_else(lag(event, n = 1L) == "Play", lag(x_coordinate_2, n = 1L), NA_real_)) %>%
mutate(rec_y = if_else(lag(event, n = 1L) == "Play", lag(y_coordinate_2, n = 1L), NA_real_)) %>%
mutate(shooter = if_else(event %in% c("Shot", "Goal"), player, NA_character_)) %>%
mutate(shot_x = if_else(event %in% c("Shot", "Goal"), x_coordinate, NA_real_)) %>%
mutate(shot_y = if_else(event %in% c("Shot", "Goal"), y_coordinate, NA_real_)) %>%
mutate(shot_type = if_else(event %in% c("Shot", "Goal"), detail_1, NA_character_)) %>%
mutate(shot_outcome = if_else(event %in% c("Shot", "Goal"), detail_2, NA_character_)) %>%
mutate(shot_traffic = if_else(event %in% c("Shot", "Goal"), detail_3, NA)) %>%
mutate(shot_onetimer = if_else(event %in% c("Shot", "Goal"), detail_4, NA)) %>%
filter(shot_from_pass == TRUE) %>%
select(-c(clock, player, detail_1, detail_2, detail_3, detail_4, player_2,
x_coordinate, y_coordinate, x_coordinate_2, y_coordinate_2,
shot_from_pass, pass_to_shot)) %>%
rename(time_since_pass = time_btw_events)# %>%
count(data$passer)
count(data, data$passer)
max(count(data, data$passer))
arrange(count(data, data$passer))
arrange(count(data, data$passer), n)
arrange(count(data, data$passer), desc(n))
data <- data_nwhl %>%
mutate(passer = if_else(lag(event, n = 1L) == "Play", lag(player, n = 1L), NA_character_)) %>%
mutate(pass_type = if_else(lag(detail_1, n = 1L) %in% c("Direct", "Indirect"), lag(detail_1, n = 1L), NA_character_)) %>%
mutate(pass_x = if_else(lag(event, n = 1L) == "Play", lag(x_coordinate, n = 1L), NA_real_)) %>%
mutate(pass_y = if_else(lag(event, n = 1L) == "Play", lag(y_coordinate, n = 1L), NA_real_)) %>%
mutate(rec_x = if_else(lag(event, n = 1L) == "Play", lag(x_coordinate_2, n = 1L), NA_real_)) %>%
mutate(rec_y = if_else(lag(event, n = 1L) == "Play", lag(y_coordinate_2, n = 1L), NA_real_)) %>%
mutate(shooter = if_else(event %in% c("Shot", "Goal"), player, NA_character_)) %>%
mutate(shot_x = if_else(event %in% c("Shot", "Goal"), x_coordinate, NA_real_)) %>%
mutate(shot_y = if_else(event %in% c("Shot", "Goal"), y_coordinate, NA_real_)) %>%
mutate(shot_type = if_else(event %in% c("Shot", "Goal"), detail_1, NA_character_)) %>%
mutate(shot_outcome = if_else(event %in% c("Shot", "Goal"), detail_2, NA_character_)) %>%
mutate(shot_traffic = if_else(event %in% c("Shot", "Goal"), detail_3, NA)) %>%
mutate(shot_onetimer = if_else(event %in% c("Shot", "Goal"), detail_4, NA)) %>%
filter(shot_from_pass == TRUE) %>%
select(-c(clock, player, detail_1, detail_2, detail_3, detail_4, player_2,
x_coordinate, y_coordinate, x_coordinate_2, y_coordinate_2,
shot_from_pass, pass_to_shot)) %>%
rename(time_since_pass = time_btw_events) %>%
# filter(time_since_pass < 3) %>%
# filter(pass_type == "Direct") %>%
# filter(shot_outcome == "On Net") %>%
# filter(team == "Boston Pride") %>%
# filter(game_date == "2021-01-23")
filter(passer == "Kaleigh Fratkin")
ggplot(data = data) +
geom_segment(aes(x = pass_x, y = pass_y, xend = rec_x, yend = rec_y),
arrow = arrow(length = unit(0.3, "cm"))) +
# scale_colour_manual(values = "red") +
geom_segment(aes(x = rec_x, y = rec_y, xend = shot_x, yend = shot_y, colour = shot_onetimer),
arrow = arrow(length = unit(0.3, "cm"))) +
labs(x = "",
y = "") +
lims(x = c(0, 200),
y = c(0, 85)) +
coord_fixed() +
theme_classic()
ggplot(data = data) +
geom_segment(aes(x = pass_x, y = pass_y, xend = rec_x, yend = rec_y),
arrow = arrow(length = unit(0.3, "cm"))) +
# scale_colour_manual(values = "red") +
geom_segment(aes(x = rec_x, y = rec_y, xend = shot_x, yend = shot_y),# colour = shot_onetimer),
arrow = arrow(length = unit(0.3, "cm"))) +
labs(x = "",
y = "") +
lims(x = c(0, 200),
y = c(0, 85)) +
coord_fixed() +
theme_classic()
data <- data_nwhl %>%
mutate(passer = if_else(lag(event, n = 1L) == "Play", lag(player, n = 1L), NA_character_)) %>%
mutate(pass_type = if_else(lag(detail_1, n = 1L) %in% c("Direct", "Indirect"), lag(detail_1, n = 1L), NA_character_)) %>%
mutate(pass_x = if_else(lag(event, n = 1L) == "Play", lag(x_coordinate, n = 1L), NA_real_)) %>%
mutate(pass_y = if_else(lag(event, n = 1L) == "Play", lag(y_coordinate, n = 1L), NA_real_)) %>%
mutate(rec_x = if_else(lag(event, n = 1L) == "Play", lag(x_coordinate_2, n = 1L), NA_real_)) %>%
mutate(rec_y = if_else(lag(event, n = 1L) == "Play", lag(y_coordinate_2, n = 1L), NA_real_)) %>%
mutate(shooter = if_else(event %in% c("Shot", "Goal"), player, NA_character_)) %>%
mutate(shot_x = if_else(event %in% c("Shot", "Goal"), x_coordinate, NA_real_)) %>%
mutate(shot_y = if_else(event %in% c("Shot", "Goal"), y_coordinate, NA_real_)) %>%
mutate(shot_type = if_else(event %in% c("Shot", "Goal"), detail_1, NA_character_)) %>%
mutate(shot_outcome = if_else(event %in% c("Shot", "Goal"), detail_2, NA_character_)) %>%
mutate(shot_traffic = if_else(event %in% c("Shot", "Goal"), detail_3, NA)) %>%
mutate(shot_onetimer = if_else(event %in% c("Shot", "Goal"), detail_4, NA)) %>%
filter(shot_from_pass == TRUE) %>%
select(-c(clock, player, detail_1, detail_2, detail_3, detail_4, player_2,
x_coordinate, y_coordinate, x_coordinate_2, y_coordinate_2,
shot_from_pass, pass_to_shot)) %>%
rename(time_since_pass = time_btw_events) %>%
# filter(time_since_pass < 3) %>%
# filter(pass_type == "Direct") %>%
# filter(shot_outcome == "On Net") %>%
# filter(team == "Boston Pride") %>%
# filter(game_date == "2021-01-23")
filter(passer == "Kaleigh Fratkin") %>%
filter(time_since_pass < 3) %>%
filter(shot_outcome == "On Net")
ggplot(data = data) +
geom_segment(aes(x = pass_x, y = pass_y, xend = rec_x, yend = rec_y),
arrow = arrow(length = unit(0.3, "cm"))) +
# scale_colour_manual(values = "red") +
geom_segment(aes(x = rec_x, y = rec_y, xend = shot_x, yend = shot_y),# colour = shot_onetimer),
arrow = arrow(length = unit(0.3, "cm"))) +
labs(x = "",
y = "") +
lims(x = c(0, 200),
y = c(0, 85)) +
coord_fixed() +
theme_classic()
data <- data_nwhl %>%
mutate(passer = if_else(lag(event, n = 1L) == "Play", lag(player, n = 1L), NA_character_)) %>%
mutate(pass_type = if_else(lag(detail_1, n = 1L) %in% c("Direct", "Indirect"), lag(detail_1, n = 1L), NA_character_)) %>%
mutate(pass_x = if_else(lag(event, n = 1L) == "Play", lag(x_coordinate, n = 1L), NA_real_)) %>%
mutate(pass_y = if_else(lag(event, n = 1L) == "Play", lag(y_coordinate, n = 1L), NA_real_)) %>%
mutate(rec_x = if_else(lag(event, n = 1L) == "Play", lag(x_coordinate_2, n = 1L), NA_real_)) %>%
mutate(rec_y = if_else(lag(event, n = 1L) == "Play", lag(y_coordinate_2, n = 1L), NA_real_)) %>%
mutate(shooter = if_else(event %in% c("Shot", "Goal"), player, NA_character_)) %>%
mutate(shot_x = if_else(event %in% c("Shot", "Goal"), x_coordinate, NA_real_)) %>%
mutate(shot_y = if_else(event %in% c("Shot", "Goal"), y_coordinate, NA_real_)) %>%
mutate(shot_type = if_else(event %in% c("Shot", "Goal"), detail_1, NA_character_)) %>%
mutate(shot_outcome = if_else(event %in% c("Shot", "Goal"), detail_2, NA_character_)) %>%
mutate(shot_traffic = if_else(event %in% c("Shot", "Goal"), detail_3, NA)) %>%
mutate(shot_onetimer = if_else(event %in% c("Shot", "Goal"), detail_4, NA)) %>%
filter(shot_from_pass == TRUE) %>%
select(-c(clock, player, detail_1, detail_2, detail_3, detail_4, player_2,
x_coordinate, y_coordinate, x_coordinate_2, y_coordinate_2,
shot_from_pass, pass_to_shot)) %>%
rename(time_since_pass = time_btw_events) #%>%
unique(data$shot_outcome)
data <- data_nwhl %>%
mutate(passer = if_else(lag(event, n = 1L) == "Play", lag(player, n = 1L), NA_character_)) %>%
mutate(pass_type = if_else(lag(detail_1, n = 1L) %in% c("Direct", "Indirect"), lag(detail_1, n = 1L), NA_character_)) %>%
mutate(pass_x = if_else(lag(event, n = 1L) == "Play", lag(x_coordinate, n = 1L), NA_real_)) %>%
mutate(pass_y = if_else(lag(event, n = 1L) == "Play", lag(y_coordinate, n = 1L), NA_real_)) %>%
mutate(rec_x = if_else(lag(event, n = 1L) == "Play", lag(x_coordinate_2, n = 1L), NA_real_)) %>%
mutate(rec_y = if_else(lag(event, n = 1L) == "Play", lag(y_coordinate_2, n = 1L), NA_real_)) %>%
mutate(shooter = if_else(event %in% c("Shot", "Goal"), player, NA_character_)) %>%
mutate(shot_x = if_else(event %in% c("Shot", "Goal"), x_coordinate, NA_real_)) %>%
mutate(shot_y = if_else(event %in% c("Shot", "Goal"), y_coordinate, NA_real_)) %>%
mutate(shot_type = if_else(event %in% c("Shot", "Goal"), detail_1, NA_character_)) %>%
mutate(shot_outcome = if_else(event %in% c("Shot", "Goal"), detail_2, NA_character_)) %>%
mutate(shot_traffic = if_else(event %in% c("Shot", "Goal"), detail_3, NA)) %>%
mutate(shot_onetimer = if_else(event %in% c("Shot", "Goal"), detail_4, NA)) %>%
filter(shot_from_pass == TRUE) %>%
select(-c(clock, player, detail_1, detail_2, detail_3, detail_4, player_2,
x_coordinate, y_coordinate, x_coordinate_2, y_coordinate_2,
shot_from_pass, pass_to_shot)) %>%
rename(time_since_pass = time_btw_events) %>%
# filter(time_since_pass < 3) %>%
# filter(pass_type == "Direct") %>%
# filter(shot_outcome == "On Net") %>%
# filter(team == "Boston Pride") %>%
# filter(game_date == "2021-01-23")
filter(passer == "Kaleigh Fratkin") %>%
filter(time_since_pass < 3) %>%
filter(shot_outcome %in% c("On Net", "Missed"))
data <- data_nwhl %>%
mutate(passer = if_else(lag(event, n = 1L) == "Play", lag(player, n = 1L), NA_character_)) %>%
mutate(pass_type = if_else(lag(detail_1, n = 1L) %in% c("Direct", "Indirect"), lag(detail_1, n = 1L), NA_character_)) %>%
mutate(pass_x = if_else(lag(event, n = 1L) == "Play", lag(x_coordinate, n = 1L), NA_real_)) %>%
mutate(pass_y = if_else(lag(event, n = 1L) == "Play", lag(y_coordinate, n = 1L), NA_real_)) %>%
mutate(rec_x = if_else(lag(event, n = 1L) == "Play", lag(x_coordinate_2, n = 1L), NA_real_)) %>%
mutate(rec_y = if_else(lag(event, n = 1L) == "Play", lag(y_coordinate_2, n = 1L), NA_real_)) %>%
mutate(shooter = if_else(event %in% c("Shot", "Goal"), player, NA_character_)) %>%
mutate(shot_x = if_else(event %in% c("Shot", "Goal"), x_coordinate, NA_real_)) %>%
mutate(shot_y = if_else(event %in% c("Shot", "Goal"), y_coordinate, NA_real_)) %>%
mutate(shot_type = if_else(event %in% c("Shot", "Goal"), detail_1, NA_character_)) %>%
mutate(shot_outcome = if_else(event %in% c("Shot", "Goal"), detail_2, NA_character_)) %>%
mutate(shot_traffic = if_else(event %in% c("Shot", "Goal"), detail_3, NA)) %>%
mutate(shot_onetimer = if_else(event %in% c("Shot", "Goal"), detail_4, NA)) %>%
filter(shot_from_pass == TRUE) %>%
select(-c(clock, player, detail_1, detail_2, detail_3, detail_4, player_2,
x_coordinate, y_coordinate, x_coordinate_2, y_coordinate_2,
shot_from_pass, pass_to_shot)) %>%
rename(time_since_pass = time_btw_events) %>%
# filter(time_since_pass < 3) %>%
# filter(pass_type == "Direct") %>%
# filter(shot_outcome == "On Net") %>%
# filter(team == "Boston Pride") %>%
# filter(game_date == "2021-01-23")
filter(passer == "Kaleigh Fratkin") %>%
filter(time_since_pass < 3) %>%
filter(shot_outcome %in% c("On Net", "Missed"))
ggplot(data = data) +
geom_segment(aes(x = pass_x, y = pass_y, xend = rec_x, yend = rec_y),
arrow = arrow(length = unit(0.3, "cm"))) +
# scale_colour_manual(values = "red") +
geom_segment(aes(x = rec_x, y = rec_y, xend = shot_x, yend = shot_y),# colour = shot_onetimer),
arrow = arrow(length = unit(0.3, "cm"))) +
labs(x = "",
y = "") +
lims(x = c(0, 200),
y = c(0, 85)) +
coord_fixed() +
theme_classic()
ggplot(data = data) +
geom_segment(aes(x = pass_x, y = pass_y, xend = rec_x, yend = rec_y),
arrow = arrow(length = unit(0.3, "cm"))) +
geom_segment(aes(x = rec_x, y = rec_y, xend = shot_x, yend = shot_y), colour = shot_outcome),
arrow = arrow(length = unit(0.3, "cm"))) +
labs(x = "",
y = "") +
lims(x = c(0, 200),
y = c(0, 85)) +
coord_fixed() +
theme_classic()
ggplot(data = data) +
geom_segment(aes(x = pass_x, y = pass_y, xend = rec_x, yend = rec_y),
arrow = arrow(length = unit(0.3, "cm"))) +
geom_segment(aes(x = rec_x, y = rec_y, xend = shot_x, yend = shot_y, colour = shot_onetimer),
arrow = arrow(length = unit(0.3, "cm"))) +
labs(x = "",
y = "") +
lims(x = c(0, 200),
y = c(0, 85)) +
coord_fixed() +
theme_classic()
ggplot(data = data) +
geom_segment(aes(x = pass_x, y = pass_y, xend = rec_x, yend = rec_y),
arrow = arrow(length = unit(0.3, "cm"))) +
geom_segment(aes(x = rec_x, y = rec_y, xend = shot_x, yend = shot_y, colour = shot_outcome),
arrow = arrow(length = unit(0.3, "cm"))) +
labs(x = "",
y = "") +
lims(x = c(0, 200),
y = c(0, 85)) +
coord_fixed() +
theme_classic()
